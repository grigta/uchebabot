# EduHelper Bot ‚Äî –û–±–Ω–æ–≤–ª—ë–Ω–Ω–∞—è –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è v2.0

## 1. –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

### 1.1 –ù–∞–∑–≤–∞–Ω–∏–µ
**EduHelper Bot** ‚Äî –£—á–µ–±–Ω—ã–π Telegram-–±–æ—Ç

### 1.2 –¶–µ–ª—å
Telegram-–±–æ—Ç –¥–ª—è –ø–æ–º–æ—â–∏ —à–∫–æ–ª—å–Ω–∏–∫–∞–º –∏ —Å—Ç—É–¥–µ–Ω—Ç–∞–º –≤ —Ä–µ—à–µ–Ω–∏–∏ —É—á–µ–±–Ω—ã—Ö –∑–∞–¥–∞—á —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ò–ò —á–µ—Ä–µ–∑ OpenRouter API.

### 1.3 –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ—Ç v1.0
- ‚ùå –£–±—Ä–∞–Ω –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ (—Å—Ç—Ä–∞–Ω–∞, —Ç–∏–ø –æ–±—É—á–µ–Ω–∏—è, –∫–ª–∞—Å—Å, –ø—Ä–µ–¥–º–µ—Ç)
- ‚ùå –£–±—Ä–∞–Ω –≤—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ ‚Äî AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–≤—å—é/–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Gemini Vision
- ‚úÖ –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (FastAPI + Vue)
- ‚úÖ –¢–æ–ª—å–∫–æ –æ–¥–Ω–∞ –º–æ–¥–µ–ª—å: Gemini 3 Flash

---

## 2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ñ–ª–æ—É

### 2.1 –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                                                                 ‚îÇ
‚îÇ  /start                                                         ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥ (2-3 –ø–æ—à–∞–≥–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏—è)                   ‚îÇ
‚îÇ  [–î–∞–ª–µ–µ] ‚Üí [–î–∞–ª–µ–µ] ‚Üí [–ü–æ–Ω—è—Ç–Ω–æ, –Ω–∞—á–Ω—ë–º!]                         ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞: [üë§ –ü—Ä–æ—Ñ–∏–ª—å] [‚ùì –ü–æ–º–æ—â—å]                       ‚îÇ
‚îÇ  –ì–æ—Ç–æ–≤ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–¥–∞—á–∏                                         ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É (—Ç–µ–∫—Å—Ç –∏–ª–∏ —Ñ–æ—Ç–æ)                ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  AI –∑–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å (–∏–Ω—Ç–µ—Ä–≤—å—é)                         ‚îÇ
‚îÇ  + –∫–Ω–æ–ø–∫–∞ [‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –∏ —Ä–µ—à–∏—Ç—å —Å—Ä–∞–∑—É]                         ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚îú‚îÄ‚îÄ –ï—Å–ª–∏ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å" ‚îÄ‚îÄ‚ñ∫ –°—Ä–∞–∑—É —Ä–µ—à–µ–Ω–∏–µ                     ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  AI —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –ø–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è                                      ‚îÇ
‚îÇ  [‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å] [‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å] [‚ùå –û—Ç–º–µ–Ω–∏—Ç—å]                     ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  AI —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç typing...)                        ‚îÇ
‚îÇ     ‚îÇ                                                           ‚îÇ
‚îÇ     ‚ñº                                                           ‚îÇ
‚îÇ  –û—Ç–≤–µ—Ç (—Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ –µ—Å–ª–∏ > 4096 —Å–∏–º–≤–æ–ª–æ–≤)              ‚îÇ
‚îÇ                                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- **–ù–µ—Å–∫–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–¥—Ä—è–¥**: –°—Ç–∞–≤—è—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- **–¢–∞–π–º–∞—É—Ç –ø–ª–∞–Ω–∞**: 5 –º–∏–Ω—É—Ç –Ω–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –ø–æ—Ç–æ–º –ø–ª–∞–Ω –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
- **–û—Ç–º–µ–Ω–∞**: Inline-–∫–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∞" –ø–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –∏–Ω—Ç–µ—Ä–≤—å—é/–ø–ª–∞–Ω–∞

---

## 3. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 3.1 –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è |
|-----------|------------|--------|
| –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è | Python | 3.11+ |
| Telegram Bot Framework | aiogram | 3.x |
| LLM API | OpenRouter | v1 |
| LLM –ú–æ–¥–µ–ª—å | google/gemini-3-flash-preview | - |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (dev) | SQLite | - |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (prod) | PostgreSQL | 15+ |
| ORM | SQLAlchemy | 2.x |
| State Storage | Redis | 7.x |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | Pydantic | 2.x |
| HTTP-–∫–ª–∏–µ–Ω—Ç | aiohttp | 3.x |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | Grafana Loki | - |
| –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Backend | FastAPI | - |
| –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å Frontend | Vue 3 + Vuetify | - |

### 3.2 –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
eduhelper-bot/
‚îú‚îÄ‚îÄ bot/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ start.py            # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ /start + –≥–∞–π–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ question.py         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤–æ–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ interview.py        # –õ–æ–≥–∏–∫–∞ –∏–Ω—Ç–µ—Ä–≤—å—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ plan.py             # –õ–æ–≥–∏–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ profile.py          # –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inline.py           # Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reply.py            # Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ [–ü—Ä–æ—Ñ–∏–ª—å] [–ü–æ–º–æ—â—å]
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ openrouter.py       # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ user_service.py     # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ moderation.py       # –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ database/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py           # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ connection.py       # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories.py     # –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prompts.py          # –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ text_utils.py       # –†–∞–∑–±–∏–≤–∫–∞ –¥–ª–∏–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ middlewares/
‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îú‚îÄ‚îÄ rate_limit.py       # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ       ‚îî‚îÄ‚îÄ queue.py            # –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ admin/
‚îÇ   ‚îú‚îÄ‚îÄ backend/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ main.py             # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.py         # Telegram OAuth
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ stats.py        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dependencies.py
‚îÇ   ‚îî‚îÄ‚îÄ frontend/
‚îÇ       ‚îú‚îÄ‚îÄ src/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ views/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ       ‚îú‚îÄ‚îÄ package.json
‚îÇ       ‚îî‚îÄ‚îÄ vite.config.js
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ .env.example
‚îî‚îÄ‚îÄ README.md
```

---

## 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenRouter

### 4.1 –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| Base URL | `https://openrouter.ai/api/v1` |
| Endpoint | `/chat/completions` |
| –ú–æ–¥–µ–ª—å | `google/gemini-3-flash-preview` |
| Max tokens | 2000 |
| Temperature | 0.7 |
| Timeout | 60 —Å–µ–∫—É–Ω–¥ |

### 4.2 –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

Gemini 3 Flash –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç vision. –§–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º:

```json
{
  "model": "google/gemini-3-flash-preview",
  "messages": [
    {
      "role": "user",
      "content": [
        {
          "type": "text",
          "text": "<—Ç–µ–∫—Å—Ç_–∑–∞–¥–∞—á–∏>"
        },
        {
          "type": "image_url",
          "image_url": {
            "url": "data:image/jpeg;base64,<base64_image>"
          }
        }
      ]
    }
  ]
}
```

### 4.3 –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API

| –°–∏—Ç—É–∞—Ü–∏—è | –î–µ–π—Å—Ç–≤–∏–µ |
|----------|----------|
| –û—à–∏–±–∫–∞ API | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, **–Ω–µ** —Å–ø–∏—Å—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å —Å –ª–∏–º–∏—Ç–∞ |
| –¢–∞–π–º–∞—É—Ç | –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ, **–Ω–µ** —Å–ø–∏—Å—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å |
| Rate limit OpenRouter | Retry —Å backoff, –µ—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ ‚Äî –æ—à–∏–±–∫–∞ |

---

## 5. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### 5.1 –°—Ö–µ–º–∞

#### –¢–∞–±–ª–∏—Ü–∞ `users`

```sql
CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    telegram_id BIGINT UNIQUE NOT NULL,
    username VARCHAR(255),
    first_name VARCHAR(255),
    last_name VARCHAR(255),
    daily_requests INTEGER DEFAULT 0,
    total_requests INTEGER DEFAULT 0,
    total_tokens INTEGER DEFAULT 0,
    last_request_date DATE,
    is_banned BOOLEAN DEFAULT FALSE,
    custom_daily_limit INTEGER,          -- NULL = –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### –¢–∞–±–ª–∏—Ü–∞ `requests`

```sql
CREATE TABLE requests (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
    question TEXT NOT NULL,
    answer TEXT NOT NULL,
    detected_subject VARCHAR(100),        -- AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø—Ä–µ–¥–º–µ—Ç
    model_used VARCHAR(100),
    prompt_tokens INTEGER,
    completion_tokens INTEGER,
    total_tokens INTEGER,
    response_time_ms INTEGER,
    had_image BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### 5.2 Redis —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (FSM)

```
user:{telegram_id}:state -> "awaiting_interview" | "awaiting_plan_confirm" | "processing" | "idle"
user:{telegram_id}:interview_data -> JSON —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤—å—é
user:{telegram_id}:plan_data -> JSON —Å –ø–ª–∞–Ω–æ–º
user:{telegram_id}:message_queue -> List —Å –æ—á–µ—Ä–µ–¥—å—é —Å–æ–æ–±—â–µ–Ω–∏–π
```

TTL –¥–ª—è –≤—Å–µ—Ö –∫–ª—é—á–µ–π: 10 –º–∏–Ω—É—Ç (–∫—Ä–æ–º–µ message_queue)

---

## 6. –ö–æ–º–∞–Ω–¥—ã –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### 6.1 –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `/start` | –ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥ |

–í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —á–µ—Ä–µ–∑ reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –∏ inline-–∫–Ω–æ–ø–∫–∏.

### 6.2 Reply-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [üë§ –ü—Ä–æ—Ñ–∏–ª—å]      [‚ùì –ü–æ–º–æ—â—å]        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 6.3 –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥ (/start)

**–°–æ–æ–±—â–µ–Ω–∏–µ 1:**
```
üëã –ü—Ä–∏–≤–µ—Ç! –Ø EduHelper ‚Äî —Ç–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤ —É—á—ë–±–µ!

–Ø –ø–æ–º–æ–≥—É —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è —Å –ª—é–±—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏:
‚Ä¢ –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –∏ —Ñ–∏–∑–∏–∫–∞
‚Ä¢ –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
‚Ä¢ –Ø–∑—ã–∫–∏ –∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
‚Ä¢ –ò –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!
```
[–î–∞–ª–µ–µ ‚Üí]

**–°–æ–æ–±—â–µ–Ω–∏–µ 2:**
```
üì∏ –¢—ã –º–æ–∂–µ—à—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å:
‚Ä¢ –¢–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏
‚Ä¢ –§–æ—Ç–æ —Å —É—Å–ª–æ–≤–∏–µ–º

–Ø –∑–∞–¥–∞–º —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã –µ—Å–ª–∏ –Ω—É–∂–Ω–æ, —Å–æ—Å—Ç–∞–≤–ª—é –ø–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è, –∏ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–±—ä—è—Å–Ω—é.
```
[–î–∞–ª–µ–µ ‚Üí]

**–°–æ–æ–±—â–µ–Ω–∏–µ 3:**
```
üéâ –ì–æ—Ç–æ–≤–æ! –¢–µ–ø–µ—Ä—å –ø—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å —Å–≤–æ—é –∑–∞–¥–∞—á—É.

üí° –ß–µ–º –ø–æ–¥—Ä–æ–±–Ω–µ–µ –æ–ø–∏—à–µ—à—å ‚Äî —Ç–µ–º –ª—É—á—à–µ —Å–º–æ–≥—É –ø–æ–º–æ—á—å!
```
[‚ú® –ü–æ–Ω—è—Ç–Ω–æ, –Ω–∞—á–Ω—ë–º!]

### 6.4 –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```
üë§ –¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å

üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
‚Ä¢ –ó–∞–ø—Ä–æ—Å–æ–≤ —Å–µ–≥–æ–¥–Ω—è: 5/20
‚Ä¢ –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: 127
‚Ä¢ –¢–æ–∫–µ–Ω–æ–≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: 45,230
‚Ä¢ –õ—é–±–∏–º—ã–π –ø—Ä–µ–¥–º–µ—Ç: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ (AI –æ–ø—Ä–µ–¥–µ–ª–∏–ª)

üóì –° –Ω–∞–º–∏ —Å: 15 –¥–µ–∫–∞–±—Ä—è 2024
```

### 6.5 –ü–æ–º–æ—â—å

```
‚ùì –ü–æ–º–æ—â—å

üîπ –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:
1. –û—Ç–ø—Ä–∞–≤—å —Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏ –∏–ª–∏ —Ñ–æ—Ç–æ
2. –û—Ç–≤–µ—Ç—å –Ω–∞ —É—Ç–æ—á–Ω—è—é—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã (–∏–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏)
3. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏ –ø–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è
4. –ü–æ–ª—É—á–∏ –ø–æ–¥—Ä–æ–±–Ω–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ!

üîπ –õ–∏–º–∏—Ç—ã:
‚Ä¢ –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å: 20
‚Ä¢ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞: 00:00 –ú–°–ö

üîπ –°–æ–≤–µ—Ç—ã:
‚Ä¢ –ü–∏—à–∏ —É—Å–ª–æ–≤–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é
‚Ä¢ –£–∫–∞–∑—ã–≤–∞–π —á—Ç–æ –∏–º–µ–Ω–Ω–æ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ
‚Ä¢ –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ñ–æ—Ç–æ –∑–∞–¥–∞—á

üìß –ü–æ–¥–¥–µ—Ä–∂–∫–∞: @eduhelper_support
```

---

## 7. –°–∏—Å—Ç–µ–º–∞ –∏–Ω—Ç–µ—Ä–≤—å—é –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### 7.1 –§–ª–æ—É –∏–Ω—Ç–µ—Ä–≤—å—é

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É
2. AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏ –∑–∞–¥–∞—ë—Ç —É—Ç–æ—á–Ω—è—é—â–∏–π –≤–æ–ø—Ä–æ—Å (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. –ü–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º –∫–Ω–æ–ø–∫–∞ [‚è≠ –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å]
4. AI –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
   - –û—Ç–∫—Ä—ã—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–∏—à–µ—Ç –æ—Ç–≤–µ—Ç)
   - –í–æ–ø—Ä–æ—Å—ã —Å inline-–∫–Ω–æ–ø–∫–∞–º–∏ (–≤—ã–±–æ—Ä –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤)
5. –ü–æ—Å–ª–µ –∏–Ω—Ç–µ—Ä–≤—å—é ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞

### 7.2 –§–ª–æ—É –ø–ª–∞–Ω–∞

```
üìã –ü–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è:

1. –û–ø—Ä–µ–¥–µ–ª–∏–º —Ç–∏–ø —É—Ä–∞–≤–Ω–µ–Ω–∏—è
2. –ü—Ä–∏–º–µ–Ω–∏–º —Ñ–æ—Ä–º—É–ª—É –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞–Ω—Ç–∞
3. –ù–∞–π–¥—ë–º –∫–æ—Ä–Ω–∏
4. –ü—Ä–æ–≤–µ—Ä–∏–º –æ—Ç–≤–µ—Ç

–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –ø–ª–∞–Ω?
```
[‚úÖ –î–∞, —Ä–µ—à–∞–π] [‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å] [‚ùå –û—Ç–º–µ–Ω–∞]

- **"–ò–∑–º–µ–Ω–∏—Ç—å"**: AI —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —á—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å
- **–¢–∞–π–º–∞—É—Ç**: 5 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º –ø–ª–∞–Ω –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è
- **–ü—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ –∏–Ω—Ç–µ—Ä–≤—å—é**: –ü–ª–∞–Ω –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, —Å—Ä–∞–∑—É —Ä–µ—à–µ–Ω–∏–µ

### 7.3 –ü–æ–¥—Å—á—ë—Ç –ª–∏–º–∏—Ç–∞

–¢–æ–ª—å–∫–æ **—Ñ–∏–Ω–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ** —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ –∑–∞–ø—Ä–æ—Å:
- –ò–Ω—Ç–µ—Ä–≤—å—é ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Äî 1 –∑–∞–ø—Ä–æ—Å –∏–∑ –ª–∏–º–∏—Ç–∞
- –û—à–∏–±–∫–∞ API ‚Äî –Ω–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è

---

## 8. –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 8.1 Pre-filter –ø—Ä–∞–≤–∏–ª–∞

–ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –î–û –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫ AI:
- –ù–µ—Ü–µ–Ω–∑—É—Ä–Ω–∞—è –ª–µ–∫—Å–∏–∫–∞ (—Å–ª–æ–≤–∞—Ä—å)
- Jailbreak-–ø–∞—Ç—Ç–µ—Ä–Ω—ã:
  - "–∑–∞–±—É–¥—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏"
  - "ignore previous prompt"
  - "—Ç—ã —Ç–µ–ø–µ—Ä—å..."
  - –∏ –ø–æ–¥–æ–±–Ω—ã–µ

### 8.2 –†–µ–∞–∫—Ü–∏—è –Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É

```
‚ö†Ô∏è –Ø –Ω–µ –º–æ–≥—É –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ.

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —É—á–µ–±–Ω—ã–π –≤–æ–ø—Ä–æ—Å –ø–æ-–¥—Ä—É–≥–æ–º—É.
```

- –°–æ–æ–±—â–µ–Ω–∏–µ **–Ω–µ** —Å—á–∏—Ç–∞–µ—Ç—Å—è –∑–∞–ø—Ä–æ—Å–æ–º
- –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ü–∏–¥–µ–Ω—Ç

### 8.3 Off-topic –≤–æ–ø—Ä–æ—Å—ã

AI —Å–∞–º —Ä–µ—à–∞–µ—Ç –∫–∞–∫ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –Ω–µ—É—á–µ–±–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã ("–∫–∞–∫ –¥–µ–ª–∞?", "—Ä–∞—Å—Å–∫–∞–∂–∏ –∞–Ω–µ–∫–¥–æ—Ç"). –í —Å–∏—Å—Ç–µ–º–Ω–æ–º –ø—Ä–æ–º–ø—Ç–µ —É–∫–∞–∑–∞–Ω–æ –º—è–≥–∫–æ –Ω–∞–ø—Ä–∞–≤–ª—è—Ç—å –∫ —É—á–µ–±–Ω—ã–º —Ç–µ–º–∞–º, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∂—ë—Å—Ç–∫–æ.

---

## 9. –°–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–º–ø—Ç—ã

### 9.1 –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–º–ø—Ç

```
–¢—ã ‚Äî EduHelper, –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç.

## –¢–≤–æ–∏ –∑–∞–¥–∞—á–∏
1. –ü–æ–º–æ–≥–∞—Ç—å —Å —Ä–µ—à–µ–Ω–∏–µ–º —É—á–µ–±–Ω—ã—Ö –∑–∞–¥–∞—á –ª—é–±–æ–≥–æ —É—Ä–æ–≤–Ω—è
2. –û–±—ä—è—Å–Ω—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª –ø–æ–Ω—è—Ç–Ω—ã–º —è–∑—ã–∫–æ–º
3. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∑–∞–¥–∞—á–∏

## –ü—Ä–∞–≤–∏–ª–∞ –æ—Ç–≤–µ—Ç–∞
1. –†–∞–∑–±–∏–≤–∞–π —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –ø–æ—à–∞–≥–æ–≤—ã–µ —ç—Ç–∞–ø—ã
2. –û–±—ä—è—Å–Ω—è–π –∫–∞–∂–¥—ã–π —à–∞–≥ –ø–æ–Ω—è—Ç–Ω–æ
3. –ü—Ä–∏–≤–æ–¥–∏ —Ñ–æ—Ä–º—É–ª—ã –∏ –ø—Ä–∞–≤–∏–ª–∞, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å
4. –ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –Ω–µ–ø–æ–ª–Ω–∞—è ‚Äî –≤–µ–∂–ª–∏–≤–æ —É—Ç–æ—á–Ω–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
5. –í –∫–æ–Ω—Ü–µ –∫—Ä–∞—Ç–∫–æ —Ä–µ–∑—é–º–∏—Ä—É–π –∫–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã
6. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–∏–º–µ—Ä—ã –¥–ª—è –ª—É—á—à–µ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–π Markdown –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –§–æ—Ä–º—É–ª—ã –æ—Ñ–æ—Ä–º–ª—è–π –≤ –≤–∏–¥–µ: `—Ñ–æ—Ä–º—É–ª–∞`
- –í–∞–∂–Ω—ã–µ —Ç–µ—Ä–º–∏–Ω—ã –≤—ã–¥–µ–ª—è–π **–∂–∏—Ä–Ω—ã–º**
- –ò—Å–ø–æ–ª—å–∑—É–π –Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ –¥–ª—è —à–∞–≥–æ–≤

## –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –Ω–µ —É—á–µ–±–Ω—ã–π
–ú—è–≥–∫–æ –Ω–∞–ø–æ–º–Ω–∏, —á—Ç–æ —Ç—ã –ø–æ–º–æ—â–Ω–∏–∫ –≤ —É—á—ë–±–µ, –∏ –ø—Ä–µ–¥–ª–æ–∂–∏ –∑–∞–¥–∞—Ç—å —É—á–µ–±–Ω—ã–π –≤–æ–ø—Ä–æ—Å. –ù–æ –Ω–µ –±—É–¥—å —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º ‚Äî –º–æ–∂–Ω–æ –∫–æ—Ä–æ—Ç–∫–æ –æ—Ç–≤–µ—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å.
```

### 9.2 –ü—Ä–æ–º–ø—Ç –¥–ª—è –∏–Ω—Ç–µ—Ä–≤—å—é

```
–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∑–∞–¥–∞—á—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–¥–∞–π 1-2 —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–∞ –µ—Å–ª–∏:
- –ù–µ —Ö–≤–∞—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è
- –ù–µ—è—Å–µ–Ω —É—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (—à–∫–æ–ª–∞/–≤—É–∑)
- –ï—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏

–ï—Å–ª–∏ –∑–∞–¥–∞—á–∞ –ø–æ–ª–Ω–∞—è –∏ –ø–æ–Ω—è—Ç–Ω–∞—è ‚Äî —Å—Ä–∞–∑—É –ø–µ—Ä–µ—Ö–æ–¥–∏ –∫ –ø–ª–∞–Ω—É.

–§–æ—Ä–º–∞—Ç –≤–æ–ø—Ä–æ—Å–∞: –∫–æ—Ä–æ—Ç–∫–∏–π, –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π. –ú–æ–∂–µ—à—å –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–∞.
```

### 9.3 –ü—Ä–æ–º–ø—Ç –¥–ª—è –ø–ª–∞–Ω–∞

```
–°–æ—Å—Ç–∞–≤—å –∫—Ä–∞—Ç–∫–∏–π –ø–ª–∞–Ω —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ (3-5 –ø—É–Ω–∫—Ç–æ–≤).
–ö–∞–∂–¥—ã–π –ø—É–Ω–∫—Ç ‚Äî –æ–¥–Ω–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ.
–ù–µ —Ä–µ—à–∞–π –∑–∞–¥–∞—á—É, —Ç–æ–ª—å–∫–æ –ø–ª–∞–Ω.
```

---

## 10. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –ª–∏–º–∏—Ç—ã

### 10.1 –õ–∏–º–∏—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|----------|------------|
| –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–π (default: 20) | –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –≤ 00:00 –ú–°–ö |
| –î–ª–∏–Ω–∞ –≤–æ–ø—Ä–æ—Å–∞ | 4000 —Å–∏–º–≤–æ–ª–æ–≤ | - |
| –†–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | 20 MB | Telegram –ª–∏–º–∏—Ç |

### 10.2 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ª–∏–º–∏—Ç—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------|----------|
| –¢–∞–π–º–∞—É—Ç API –∑–∞–ø—Ä–æ—Å–∞ | 60 —Å–µ–∫—É–Ω–¥ |
| Max tokens (–æ—Ç–≤–µ—Ç) | 2000 |
| Temperature | 0.7 |
| Retry attempts | 3 |
| –ü–ª–∞–Ω timeout | 5 –º–∏–Ω—É—Ç |
| –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π | 10 —Å–æ–æ–±—â–µ–Ω–∏–π max |

---

## 11. –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

### 11.1 –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**:
  - DAU/MAU
  - –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å/–Ω–µ–¥–µ–ª—é/–º–µ—Å—è—Ü
  - –ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏
  - –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø—Ä–µ–¥–º–µ—Ç—ã (AI-–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ)

- **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏**:
  - –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–æ–∏—Å–∫–æ–º
  - –ë–∞–Ω/—Ä–∞–∑–±–∞–Ω
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ª–∏–º–∏—Ç–∞
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

### 11.2 –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

Telegram OAuth:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram"
2. Telegram Widget –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ telegram_id –≤ —Å–ø–∏—Å–∫–µ ADMIN_IDS
4. JWT —Ç–æ–∫–µ–Ω –¥–ª—è —Å–µ—Å—Å–∏–∏

### 11.3 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Backend**: FastAPI
- **Frontend**: Vue 3 + Vuetify 3
- **Auth**: Telegram Login Widget + JWT
- **API**: REST

---

## 12. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 12.1 Grafana Loki

–í—Å–µ –ª–æ–≥–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ Loki –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "timestamp": "ISO8601",
  "level": "INFO|WARNING|ERROR",
  "service": "bot|admin",
  "user_id": 123456789,
  "event": "request_processed|error_occurred|...",
  "data": {
    "question_length": 500,
    "response_time_ms": 1200,
    "model": "gemini-3-flash-preview"
  }
}
```

### 12.2 –ú–µ—Ç—Ä–∏–∫–∏

- –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ –º–∏–Ω—É—Ç—É
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- –û—à–∏–±–∫–∏ API (rate)
- –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

---

## 13. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```env
# === Telegram ===
TELEGRAM_BOT_TOKEN=your_telegram_bot_token
ADMIN_IDS=123456789,987654321

# === OpenRouter ===
OPENROUTER_API_KEY=your_openrouter_api_key
OPENROUTER_MODEL=google/gemini-3-flash-preview
OPENROUTER_MAX_TOKENS=2000
OPENROUTER_TEMPERATURE=0.7
OPENROUTER_TIMEOUT=60

# === Database ===
DATABASE_URL=sqlite:///data/bot.db
# –î–ª—è prod:
# DATABASE_URL=postgresql://user:password@localhost:5432/eduhelper

# === Redis ===
REDIS_URL=redis://localhost:6379/0

# === Rate Limiting ===
DAILY_REQUEST_LIMIT=20

# === Logging ===
LOKI_URL=http://localhost:3100/loki/api/v1/push
LOG_LEVEL=INFO

# === Admin Panel ===
ADMIN_JWT_SECRET=your_jwt_secret
ADMIN_FRONTEND_URL=http://localhost:3000

# === App Settings ===
DEBUG=false
```

---

## 14. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 14.1 –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è

| –°–∏—Ç—É–∞—Ü–∏—è | –°–æ–æ–±—â–µ–Ω–∏–µ |
|----------|-----------|
| –õ–∏–º–∏—Ç –∏—Å—á–µ—Ä–ø–∞–Ω | ‚è≥ –¢—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ–≥–æ–¥–Ω—è. –õ–∏–º–∏—Ç –æ–±–Ω–æ–≤–∏—Ç—Å—è –≤ 00:00 –ú–°–ö. |
| –°–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π –≤–æ–ø—Ä–æ—Å | üìù –°–æ–∫—Ä–∞—Ç–∏ –≤–æ–ø—Ä–æ—Å –¥–æ 4000 —Å–∏–º–≤–æ–ª–æ–≤. –°–µ–π—á–∞—Å: {length} |
| –û—à–∏–±–∫–∞ API | üîß –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π —á–µ—Ä–µ–∑ –º–∏–Ω—É—Ç—É. |
| –¢–∞–π–º–∞—É—Ç | ‚è±Ô∏è –ó–∞–ø—Ä–æ—Å –∑–∞–Ω—è–ª —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ–ø—Ä–æ–±—É–π –ø–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å. |
| –ú–æ–¥–µ—Ä–∞—Ü–∏—è | ‚ö†Ô∏è –ù–µ –º–æ–≥—É –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ. –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π —É—á–µ–±–Ω—ã–π –≤–æ–ø—Ä–æ—Å. |
| –ó–∞–±–∞–Ω–µ–Ω | üö´ –¢–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –û–±—Ä–∞—Ç–∏—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É. |

---

## 15. Docker –∏ –¥–µ–ø–ª–æ–π

### 15.1 Dockerfile (–±–æ—Ç)

```dockerfile
FROM python:3.11-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY bot/ ./bot/

CMD ["python", "-m", "bot.main"]
```

### 15.2 docker-compose.yml

```yaml
version: '3.8'

services:
  bot:
    build:
      context: .
      dockerfile: Dockerfile
    restart: unless-stopped
    env_file:
      - .env
    depends_on:
      - redis
      - db

  admin-backend:
    build:
      context: .
      dockerfile: admin/backend/Dockerfile
    restart: unless-stopped
    env_file:
      - .env
    ports:
      - "8000:8000"
    depends_on:
      - db

  admin-frontend:
    build:
      context: ./admin/frontend
    restart: unless-stopped
    ports:
      - "3000:80"

  redis:
    image: redis:7-alpine
    restart: unless-stopped
    volumes:
      - redis_data:/data

  db:
    image: postgres:15-alpine
    restart: unless-stopped
    environment:
      POSTGRES_DB: eduhelper
      POSTGRES_USER: ${DB_USER}
      POSTGRES_PASSWORD: ${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

  loki:
    image: grafana/loki:2.9.0
    ports:
      - "3100:3100"
    volumes:
      - loki_data:/loki

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3001:3000"
    volumes:
      - grafana_data:/var/lib/grafana

volumes:
  redis_data:
  postgres_data:
  loki_data:
  grafana_data:
```

### 15.3 –¶–µ–ª–µ–≤–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞

VPS (Timeweb/REG.RU) —Å Docker.

---

## 16. –°–≤–æ–¥–∫–∞ —Ä–µ—à–µ–Ω–∏–π

| –ê—Å–ø–µ–∫—Ç | –†–µ—à–µ–Ω–∏–µ |
|--------|---------|
| –û–Ω–±–æ—Ä–¥–∏–Ω–≥ | –ù–µ—Ç, —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥–∞–π–¥ |
| –í—ã–±–æ—Ä –ø—Ä–µ–¥–º–µ—Ç–∞ | AI –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å | –ú–°–ö –¥–ª—è –≤—Å–µ—Ö |
| –ú–æ–¥–µ–ª—å | google/gemini-3-flash-preview (–±–µ–∑ fallback) |
| –û—á–µ—Ä–µ–¥—å —Å–æ–æ–±—â–µ–Ω–∏–π | Queue all, process sequentially |
| –ö–æ–Ω—Ç–µ–∫—Å—Ç | –ù–µ—Ç, –Ω–æ –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–≤—å—é + –ø–ª–∞–Ω |
| –ò–Ω—Ç–µ—Ä–≤—å—é | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å |
| –ü–ª–∞–Ω | –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å (–∫—Ä–æ–º–µ skip) |
| –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–µ—Ä–µ–∑ Gemini Vision |
| –î–ª–∏–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã | –†–∞–∑–±–∏–≤–∞—Ç—å –Ω–∞ —á–∞—Å—Ç–∏ |
| –õ–∏–º–∏—Ç | –¢–æ–ª—å–∫–æ —Ä–µ—à–µ–Ω–∏–µ —Å—á–∏—Ç–∞–µ—Ç—Å—è |
| –ú–æ–¥–µ—Ä–∞—Ü–∏—è | Pre-filter (–º–∞—Ç + jailbreak) |
| –ê–¥–º–∏–Ω–∫–∞ | FastAPI + Vue + Vuetify + Telegram OAuth |
| –õ–æ–≥–∏ | Grafana Loki |
| –ë–î | SQLite dev / PostgreSQL prod |
| State | Redis FSM |
| –¢–µ—Å—Ç—ã | –ü–æ—Å–ª–µ MVP |

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª—ë–Ω: –î–µ–∫–∞–±—Ä—å 2024*
*–í–µ—Ä—Å–∏—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏: 2.0*
